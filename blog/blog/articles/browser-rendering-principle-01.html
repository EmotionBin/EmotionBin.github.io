<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器渲染原理 | 黄伟斌的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/img/avatar.jpg">
    <link rel="stylesheet" href="/blog/css/style.css">
    <meta name="description" content="冲冲冲，淦就完事了">
    
    <link rel="preload" href="/blog/assets/css/0.styles.f87ba6bf.css" as="style"><link rel="preload" href="/blog/assets/js/app.eb18618c.js" as="script"><link rel="preload" href="/blog/assets/js/2.74b5bf19.js" as="script"><link rel="preload" href="/blog/assets/js/12.e094ae9a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.3f9e3d0f.js"><link rel="prefetch" href="/blog/assets/js/11.1756ef3d.js"><link rel="prefetch" href="/blog/assets/js/13.af56dc0f.js"><link rel="prefetch" href="/blog/assets/js/14.16a4ca49.js"><link rel="prefetch" href="/blog/assets/js/15.4b5b5c43.js"><link rel="prefetch" href="/blog/assets/js/16.ff0d64cc.js"><link rel="prefetch" href="/blog/assets/js/17.37adb295.js"><link rel="prefetch" href="/blog/assets/js/18.894e58d8.js"><link rel="prefetch" href="/blog/assets/js/19.8a356ca0.js"><link rel="prefetch" href="/blog/assets/js/20.1c23923d.js"><link rel="prefetch" href="/blog/assets/js/21.ac11cb06.js"><link rel="prefetch" href="/blog/assets/js/22.aed0cfe2.js"><link rel="prefetch" href="/blog/assets/js/23.7a3361d8.js"><link rel="prefetch" href="/blog/assets/js/24.2ca8ec0a.js"><link rel="prefetch" href="/blog/assets/js/25.c22dceac.js"><link rel="prefetch" href="/blog/assets/js/26.9d871a3c.js"><link rel="prefetch" href="/blog/assets/js/27.5b30d1dd.js"><link rel="prefetch" href="/blog/assets/js/28.cff686e2.js"><link rel="prefetch" href="/blog/assets/js/29.d19ccfaa.js"><link rel="prefetch" href="/blog/assets/js/3.168c0e15.js"><link rel="prefetch" href="/blog/assets/js/30.8b0ded56.js"><link rel="prefetch" href="/blog/assets/js/31.beb339fd.js"><link rel="prefetch" href="/blog/assets/js/32.700f39ed.js"><link rel="prefetch" href="/blog/assets/js/33.291f17d2.js"><link rel="prefetch" href="/blog/assets/js/34.33862f8f.js"><link rel="prefetch" href="/blog/assets/js/35.5fdd5538.js"><link rel="prefetch" href="/blog/assets/js/36.04f63cea.js"><link rel="prefetch" href="/blog/assets/js/37.1eb44165.js"><link rel="prefetch" href="/blog/assets/js/38.24f01db2.js"><link rel="prefetch" href="/blog/assets/js/39.0eb84eb4.js"><link rel="prefetch" href="/blog/assets/js/4.f6488527.js"><link rel="prefetch" href="/blog/assets/js/40.45911119.js"><link rel="prefetch" href="/blog/assets/js/41.57de51f5.js"><link rel="prefetch" href="/blog/assets/js/42.d8ba9086.js"><link rel="prefetch" href="/blog/assets/js/43.4f23320b.js"><link rel="prefetch" href="/blog/assets/js/44.b7797a28.js"><link rel="prefetch" href="/blog/assets/js/5.94131642.js"><link rel="prefetch" href="/blog/assets/js/6.22294c7e.js"><link rel="prefetch" href="/blog/assets/js/7.2fc67102.js"><link rel="prefetch" href="/blog/assets/js/8.1167a964.js"><link rel="prefetch" href="/blog/assets/js/9.7b207526.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.f87ba6bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">黄伟斌的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/EmotionBin/vue-press-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/EmotionBin/vue-press-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端琐事</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>跨端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/articles/browser-rendering-principle-01.html" aria-current="page" class="active sidebar-link">浏览器渲染原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#进程和线程" class="sidebar-link">进程和线程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#浏览器的多进程架构" class="sidebar-link">浏览器的多进程架构</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#浏览器的主要进程" class="sidebar-link">浏览器的主要进程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#浏览器渲染进程-浏览器内核" class="sidebar-link">浏览器渲染进程(浏览器内核)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#gui-渲染线程" class="sidebar-link">GUI 渲染线程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#js-引擎线程" class="sidebar-link">JS 引擎线程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#事件触发线程" class="sidebar-link">事件触发线程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#定时触发器线程" class="sidebar-link">定时触发器线程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#异步-http-请求线程" class="sidebar-link">异步 http 请求线程</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#浏览器渲染过程" class="sidebar-link">浏览器渲染过程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#关于浏览器渲染的细节" class="sidebar-link">关于浏览器渲染的细节</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#关键渲染路径" class="sidebar-link">关键渲染路径</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#回流和重绘" class="sidebar-link">回流和重绘</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#gui-渲染线程与-js-引擎线程互斥" class="sidebar-link">GUI 渲染线程与 JS 引擎线程互斥</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#输入一个-url-按下回车后发生了什么" class="sidebar-link">输入一个 url 按下回车后发生了什么</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/browser-rendering-principle-01.html#结束语" class="sidebar-link">结束语</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>demo合集</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="浏览器渲染原理"><a href="#浏览器渲染原理" class="header-anchor">#</a> 浏览器渲染原理</h1> <p>浏览器可以让我们看到各种各样的网页，那么浏览器肯定也有着自己的一套渲染网页的机制，作为一名合格的前端攻城狮，必须要对浏览器的渲染机制以及渲染原理有一个了解，这样会对我们的开发有着至关重要的作用，对页面的性能优化也有很大的帮助</p> <h2 id="进程和线程"><a href="#进程和线程" class="header-anchor">#</a> 进程和线程</h2> <p>首先要了解操作系统中两个重要的概念，就是进程和线程</p> <p><strong>进程</strong>是 CPU 资源分配的最小单位（是能拥有资源和独立运行的最小单位）</p> <p><strong>线程</strong>是 CPU 调度的最小单位（是建立在进程基础上的一次程序运行单位）</p> <p>对于操作系统来说，一个任务就是一个进程，在一个进程内部，要同时做多件事，就需要同时运行多个<strong>子任务</strong>，我们把进程内的这些子任务称为线程，所以<strong>线程是跑在进程里面的</strong></p> <hr> <h2 id="浏览器的多进程架构"><a href="#浏览器的多进程架构" class="header-anchor">#</a> 浏览器的多进程架构</h2> <p>就拿<code>Chrome</code>来说，<code>Chrome</code>是多进程的，每新开一个 <code>Chrome</code> 网页就相当于开启了一个新的进程，每个 tab 网页都是一个独立的进程</p> <p>多进程的优点：</p> <ul><li>单个 tab 页面崩溃不会影响到整个浏览器</li> <li>第三方插件崩溃也不会影响到整个浏览器</li> <li>多进程可以充分利用现代 CPU 多核的优势</li> <li>方便使用沙盒模型隔离插件等进程，提高浏览器稳定性</li></ul> <p>多进程的缺点：</p> <ul><li>每个新开的进程都会分配 CPU、内存等资源，对设备要求较高，资源消耗大</li></ul> <hr> <h2 id="浏览器的主要进程"><a href="#浏览器的主要进程" class="header-anchor">#</a> 浏览器的主要进程</h2> <p><code>Chrome</code>的每一个页面都是一个独立的进程，在这个独立的进程中又存在多个进程，浏览器的进程主要包括以下四部分：</p> <ol><li>主进程：负责浏览器界面的显示与交互。各个页面的管理,创建和销毁其他进程。网络的资源管理、下载等</li> <li>第三方插件进程：每种类型的插件对应一个进程,仅当使用该插件时才创建</li> <li>GPU 进程：最多只有一个,用于 3D 绘制等</li> <li>渲染进程：称为浏览器渲染进程或浏览器内核,内部是多线程的。主要负责页面渲染,脚本执行,事件处理等</li></ol> <p><a href="https://s1.ax1x.com/2020/06/14/NSnb7T.png" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2020/06/14/NSnb7T.png" alt="NSnb7T.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>这些进程负责着浏览器运行时的各个角色，其中 <strong>渲染进程(也叫浏览器内核)</strong> 是重点</p> <hr> <h2 id="浏览器渲染进程-浏览器内核"><a href="#浏览器渲染进程-浏览器内核" class="header-anchor">#</a> 浏览器渲染进程(浏览器内核)</h2> <p><code>Chrome</code>的每一个页面都是一个独立的进程，在每个独立的进程下面，又会有不同的线程跑在这个进程中。渲染进程就是多线程的，它包括 GUI 渲染线程、JS 引擎线程、事件触发线程、定时触发器线程、异步 http 请求线程</p> <p><a href="https://s1.ax1x.com/2020/06/14/NSuOqP.png" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2020/06/14/NSuOqP.png" alt="NSuOqP.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="gui-渲染线程"><a href="#gui-渲染线程" class="header-anchor">#</a> GUI 渲染线程</h3> <ul><li>负责渲染浏览器界面,解析 <code>HTML</code> , <code>CSS</code> ,构建 <code>DOM</code> 树和 <code>RenderObject</code> 树,布局和绘制等</li> <li>当界面需要重绘（Repaint）或由于某种操作引发回流(reflow)时,该线程就会执行</li> <li>注意,<strong>GUI 渲染线程与 JS 引擎线程是互斥的</strong>,当 JS 引擎执行时 GUI 线程会被挂起（相当于被冻结了）,GUI 更新会被保存在一个队列中等到 JS 引擎空闲时立即被执行</li></ul> <hr> <h3 id="js-引擎线程"><a href="#js-引擎线程" class="header-anchor">#</a> JS 引擎线程</h3> <ul><li><code>Javascript</code> 引擎,也称为 JS 内核,负责处理 <code>Javascript</code> 脚本程序（例如 V8 引擎）</li> <li>JS 引擎线程负责解析 <code>Javascript</code> 脚本,运行代码</li> <li>JS 引擎一直等待着任务队列中任务的到来,然后加以处理,一个 Tab 页（renderer 进程）中无论什么时候都只有一个 JS 线程在运行 JS 程序</li> <li>注意,<strong>GUI 渲染线程与 JS 引擎线程是互斥的</strong>,所以如果 JS 执行的时间过长,这样就会造成页面的渲染不连贯,导致页面渲染加载阻塞</li></ul> <hr> <h3 id="事件触发线程"><a href="#事件触发线程" class="header-anchor">#</a> 事件触发线程</h3> <ul><li>归属于浏览器而不是 JS 引擎，用来控制事件循环（可以理解，JS 引擎自己都忙不过来，需要浏览器另开线程协助）</li> <li>当 JS 引擎执行代码块如 <code>setTimeOut</code> 时（也可来自浏览器内核的其他线程,如鼠标点击、AJAX 异步请求等）,会将对应任务添加到事件线程中</li> <li>当对应的事件符合触发条件被触发时，该线程会把事件添加到待处理队列的队尾，等待 JS 引擎的处理</li> <li>注意，由于 JS 的单线程关系，所以这些待处理队列中的事件都得排队等待 JS 引擎处理（当 JS 引擎空闲时才会去执行）</li></ul> <hr> <h3 id="定时触发器线程"><a href="#定时触发器线程" class="header-anchor">#</a> 定时触发器线程</h3> <ul><li>传说中的 <code>setInterval</code> 与 <code>setTimeout</code> 所在线程</li> <li>浏览器定时计数器并不是由 <code>JavaScript</code> 引擎计数的,（因为 <code>JavaScript</code> 引擎是单线程的, 如果处于阻塞线程状态就会影响计时的准确）</li> <li>因此通过单独线程来计时并触发定时（计时完毕后,添加到事件队列中,等待 JS 引擎空闲后执行）</li> <li>注意,W3C 在 <code>HTML</code> 标准中规定,规定要求 <code>setTimeout</code> 中低于 4ms 的时间间隔算为 4ms</li></ul> <h3 id="异步-http-请求线程"><a href="#异步-http-请求线程" class="header-anchor">#</a> 异步 http 请求线程</h3> <ul><li><code>XMLHttpRequest</code> 在连接后是通过浏览器新开一个线程发起请求</li> <li>将检测到状态变更时,如果设置有回调函数,异步线程就产生状态变更事件,将这个回调再放入事件队列中。再由 <code>JavaScript</code> 引擎执行</li></ul> <hr> <h2 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="header-anchor">#</a> 浏览器渲染过程</h2> <p>这张图是一张比较经典的图，它大致描述了浏览器渲染的主要过程：</p> <p><a href="https://s1.ax1x.com/2020/06/15/NC4soQ.png" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2020/06/15/NC4soQ.png" alt="NC4soQ.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>浏览器在获取到文件后，渲染过程主要分为以下几个步骤：</p> <ol><li>解析 <code>HTML</code> 文件,构建 <code>DOM</code> 树,同时浏览器主进程负责下载 <code>CSS</code> 文件</li> <li><code>CSS</code> 文件下载完成,解析 <code>CSS</code> 文件成树形的数据结构(<code>CSSOM</code>),然后结合 <code>DOM</code> 树合并成 <code>RenderObject</code> 树</li> <li>布局 <code>RenderObject</code> 树 （Layout/reflow）,负责 <code>RenderObject</code> 树中的元素的尺寸,位置等计算</li> <li>绘制 <code>RenderObject</code> 树 （paint）,绘制页面的像素信息</li> <li>浏览器主进程将默认的图层和复合图层交给 GPU 进程,GPU 进程再将各个图层合成（composite）,最后显示出页面</li></ol> <hr> <h2 id="关于浏览器渲染的细节"><a href="#关于浏览器渲染的细节" class="header-anchor">#</a> 关于浏览器渲染的细节</h2> <h3 id="关键渲染路径"><a href="#关键渲染路径" class="header-anchor">#</a> 关键渲染路径</h3> <p>在浏览器拿到 HTML、CSS、JS 等外部资源到渲染出页面的过程，有一个重要的概念叫<strong>关键渲染路径</strong>，关键渲染路径是浏览器将 HTML 、CSS 、 JS 转换为在屏幕上呈现的像素内容所经历的一系列步骤</p> <hr> <h4 id="html"><a href="#html" class="header-anchor">#</a> HTML</h4> <p>HTML 文件会经过解析之后生成 <code>DOM Tree</code>，有了<code>DOM Tree</code>才能显示网页，所以 HTML 是必须的</p> <p>可以从以下方面优化 HTML 的渲染</p> <ul><li>在生产环境下，删除不必要的代码和注释包括空格,尽量做到最小化文件</li> <li>可以利用 <code>GZIP</code> 压缩文件</li> <li>结合 <code>HTTP</code> 缓存文件</li></ul> <hr> <h4 id="css"><a href="#css" class="header-anchor">#</a> CSS</h4> <p><strong>CSS 是由单独的下载线程异步下载的</strong>，所以浏览器可以一边下载 CSS 资源，一边进行 <code>DOM</code>解析构建。我们知道要想显示页面，必须要在生成渲染树(<code>Render Tree</code>)之后才能显示，而<code>Render Tree</code>又依赖于<code>DOM Tree</code>和<code>CSSOM Tree</code>，所以必须等待到 <code>CSSOM Tree</code> 构建完成,也就是 CSS 资源加载完成(或者 CSS 资源加载失败)后,才能开始渲染</p> <p>综上所述， CSS 在关键渲染路径中有以下特点：</p> <ol><li>CSS 加载不会阻塞 <code>DOM</code> 的解析（异步加载时<code>DOM</code>照常构建）</li> <li>CSS 加载会阻塞 <code>DOM</code> 的渲染（渲染时需等 CSS 加载完毕，因为<code>Render Tree</code>依赖于 CSS）</li> <li>CSS 加载会阻塞后面 JS 语句的执行</li></ol> <hr> <h4 id="js"><a href="#js" class="header-anchor">#</a> JS</h4> <p>JS 线程和 UI 渲染线程是互斥的，所以当脚本在执行的时候浏览器要将控制权交给 JS 线程，等到 JS 线程执行完毕再还给 UI 渲染线程，<strong>不论这个脚本是以何种形式加载的，在执行时均会阻塞 UI 的渲染</strong></p> <p>只要浏览器遇到没有 <code>defer</code> 或 <code>async</code>标记的<code>script</code>标签，浏览器会立即唤醒<code>JavaScript</code>解析器，暂停解析 HTML，如果将要执行脚本时浏览器尚未完成 <code>CSSOM</code> 的下载及构建，<strong>浏览器将延迟脚本执行和 DOM 构建，直至其完成 CSSOM 的下载和构建后，执行该脚本</strong></p> <p><strong>async:</strong> 当我们在 <code>script</code> 标签添加 <code>async</code> 属性以后，浏览器遇到这个 <code>script</code> 标签时会继续解析 <code>DOM</code>，同时脚本也不会被 <code>CSSOM</code> 阻止，即不会阻止关键渲染路径</p> <p><strong>defer:</strong> 与 <code>async</code> 的区别在于，脚本需要等到文档解析后（ <code>DOMContentLoaded</code> 事件前）执行，而 <code>async</code> 允许脚本在文档解析时位于后台运行</p> <p>带 <code>defer</code>或<code>async</code> 的脚本会与 HTML 并行下载，<strong>下载的过程不会阻塞 DOM 的构建，但是执行是会的</strong></p> <p>综上所属，JS 在关键渲染路径中有以下特点：</p> <ol><li>JS 会阻塞关键渲染路径</li> <li>带 <code>defer</code>或<code>async</code> 的脚本下载的过程不会阻塞 <code>DOM</code> 的构建，但是执行是会的</li></ol> <hr> <h4 id="关键渲染路径优化"><a href="#关键渲染路径优化" class="header-anchor">#</a> 关键渲染路径优化</h4> <p>可以从以下方面优化关键渲染路径：</p> <ul><li>最小化关键资源数: 消除它们（内联）、推迟它们的下载（<code>defer</code>）或者使它们异步解析（<code>async</code>）等等</li> <li>优化关键字节数（缩小、压缩）来减少下载时间</li> <li>优化加载剩余关键资源的顺序: 让关键资源（CSS）尽早下载以减少关键渲染路径长度</li></ul> <hr> <h3 id="回流和重绘"><a href="#回流和重绘" class="header-anchor">#</a> 回流和重绘</h3> <p>浏览器使用<strong>流式布局模型</strong>，渲染时对<code>Render Tree</code>的计算通常只需要遍历一次就可以完成(<code>table</code>及其内部元素除外)</p> <hr> <h4 id="回流"><a href="#回流" class="header-anchor">#</a> 回流</h4> <p><strong>回流(Reflow)</strong>:当页面中部分或全部元素的尺寸、结构、或某些属性发生改变时，浏览器重新渲染部分或全部文档的过程</p> <p>可能会导致回流的操作：</p> <ul><li>页面首次渲染</li> <li>浏览器窗口大小发生改变</li> <li>元素尺寸或位置发生改变</li> <li>元素内容变化（文字数量或图片大小等等）</li> <li>元素字体大小变化</li> <li>添加或者删除可见的<code>DOM</code>元素</li> <li>激活 CSS 伪类（例如：<code>:hover</code>）</li> <li>查询某些属性或调用某些方法</li></ul> <hr> <h4 id="重绘"><a href="#重绘" class="header-anchor">#</a> 重绘</h4> <p><strong>重绘(Repaint)</strong>:当页面中元素样式的改变并不影响它在文档流中的位置时（例如：<code>color</code>、<code>background-color</code>、<code>visibility</code>等），浏览器会将新样式赋予给元素并重新绘制它的过程</p> <p>可能会导致重绘的操作：</p> <ul><li>改变元素的<code>color</code></li> <li>改变元素的<code>background-color</code></li> <li>改变元素的<code>visibility</code></li></ul> <hr> <h4 id="性能影响"><a href="#性能影响" class="header-anchor">#</a> 性能影响</h4> <p><strong>回流必将引起重绘，重绘不一定会引起回流，回流比重绘的代价要更高</strong></p> <p>有时即使仅仅回流一个单一的元素，它的父元素以及任何跟随它的元素也会产生回流</p> <p>浏览器会维护一个队列，把所有引起回流和重绘的操作放入队列中，如果队列中的任务数量或者时间间隔达到一个阈值，浏览器就会将队列清空，进行一次批处理，这样可以把多次回流和重绘变成一次</p> <hr> <h4 id="如何避免"><a href="#如何避免" class="header-anchor">#</a> 如何避免</h4> <p>要想尽量避免回流和重绘，可以从 CSS 和 JS 入手</p> <p>CSS:</p> <ul><li>避免使用<code>table</code>布局</li> <li>尽可能在<code>DOM</code>树的最末端改变<code>class</code></li> <li>避免设置多层内联样式</li> <li>将动画效果应用到<code>position</code>属性为<code>absolute</code>或<code>fixed</code>的元素上</li> <li>避免使用 CSS 表达式（例如：<code>calc()</code>）</li></ul> <p>JS:</p> <ul><li>避免频繁操作样式，最好一次性重写<code>style</code>属性，或者将样式列表定义为<code>class</code>并一次性更改<code>class</code>属性</li> <li>避免频繁操作<code>DOM</code>，创建一个<code>documentFragment</code>，在它上面应用所有<code>DOM</code>操作，最后再把它添加到文档中</li> <li>也可以先为元素设置<code>display: none</code>，操作结束后再把它显示出来。因为在<code>display</code>属性为<code>none</code>的元素上进行的<code>DOM</code>操作不会引发回流和重绘</li> <li>避免频繁读取会引发回流/重绘的属性，如果确实需要多次使用，就用一个变量缓存起来</li> <li>对具有复杂动画的元素使用绝对定位，使它脱离文档流，否则会引起父元素及后续元素频繁回流</li></ul> <hr> <h3 id="gui-渲染线程与-js-引擎线程互斥"><a href="#gui-渲染线程与-js-引擎线程互斥" class="header-anchor">#</a> GUI 渲染线程与 JS 引擎线程互斥</h3> <p>由于 JS 是可操纵 <code>DOM</code> 的，如果在修改这些元素属性同时渲染界面（即 JS 线程和 UI 线程同时运行），那么渲染线程前后获得的元素数据就可能不一致了</p> <p>当 JS 引擎执行时 GUI 线程会被挂起，GUI 更新会被保存在一个队列中，等到引擎线程空闲时立即被执行</p> <hr> <h3 id="输入一个-url-按下回车后发生了什么"><a href="#输入一个-url-按下回车后发生了什么" class="header-anchor">#</a> 输入一个 url 按下回车后发生了什么</h3> <ol><li>DNS 解析</li> <li>IP 寻址</li> <li>通过三次握手建立 TCP 连接</li> <li>TCP 连接建立成功后，浏览器发送 HTTP 请求</li> <li>服务器响应数据</li> <li>浏览器收到数据，浏览器渲染进程开始渲染(具体过程可以参考本文的浏览器渲染过程，这里省略)</li></ol> <p>以上过程都是简述，如果要详细展开可以写很长很长...</p> <hr> <h2 id="结束语"><a href="#结束语" class="header-anchor">#</a> 结束语</h2> <p>作为一名前端开发攻城狮，浏览器的渲染原理是必须要掌握和理解的，如果理解了会对性能优化方面有很大的帮助。如果本文中有说的不正确的地方，欢迎大佬鞭策!</p> <p><strong>参考资料：</strong></p> <p><a href="https://segmentfault.com/a/1190000012960187" target="_blank" rel="noopener noreferrer">浅析浏览器渲染原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://juejin.im/post/5e143104e51d45414a4715f7" target="_blank" rel="noopener noreferrer">从 8 道面试题看浏览器渲染过程与性能优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://segmentfault.com/a/1190000012925872" target="_blank" rel="noopener noreferrer">从浏览器多进程到 JS 单线程，JS 运行机制最全面的一次梳理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://juejin.im/post/5a9923e9518825558251c96a" target="_blank" rel="noopener noreferrer">浏览器的回流与重绘 (Reflow &amp; Repaint)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/19/2022, 8:16:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/blog/articles/webpack-01.html" class="prev">
        关于 webpack 的那些事
      </a></span> <span class="next"><a href="/blog/blog/articles/http-cache-01.html">
        前端也要懂 HTTP 缓存机制
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.eb18618c.js" defer></script><script src="/blog/assets/js/2.74b5bf19.js" defer></script><script src="/blog/assets/js/12.e094ae9a.js" defer></script>
  </body>
</html>
