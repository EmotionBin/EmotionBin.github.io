<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>扫码登录原理 | 黄伟斌的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/img/avatar.jpg">
    <link rel="stylesheet" href="/blog/css/style.css">
    <meta name="description" content="冲冲冲，淦就完事了">
    
    <link rel="preload" href="/blog/assets/css/0.styles.f87ba6bf.css" as="style"><link rel="preload" href="/blog/assets/js/app.11eaa6f7.js" as="script"><link rel="preload" href="/blog/assets/js/2.74b5bf19.js" as="script"><link rel="preload" href="/blog/assets/js/33.a7961f50.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.39c50713.js"><link rel="prefetch" href="/blog/assets/js/11.1756ef3d.js"><link rel="prefetch" href="/blog/assets/js/12.34c3b637.js"><link rel="prefetch" href="/blog/assets/js/13.af56dc0f.js"><link rel="prefetch" href="/blog/assets/js/14.df715967.js"><link rel="prefetch" href="/blog/assets/js/15.e7a68b1b.js"><link rel="prefetch" href="/blog/assets/js/16.bf3bb350.js"><link rel="prefetch" href="/blog/assets/js/17.37adb295.js"><link rel="prefetch" href="/blog/assets/js/18.9d38c2e9.js"><link rel="prefetch" href="/blog/assets/js/19.ea5501ab.js"><link rel="prefetch" href="/blog/assets/js/20.1c23923d.js"><link rel="prefetch" href="/blog/assets/js/21.ac11cb06.js"><link rel="prefetch" href="/blog/assets/js/22.aed0cfe2.js"><link rel="prefetch" href="/blog/assets/js/23.7a3361d8.js"><link rel="prefetch" href="/blog/assets/js/24.2ca8ec0a.js"><link rel="prefetch" href="/blog/assets/js/25.c22dceac.js"><link rel="prefetch" href="/blog/assets/js/26.1595e9e5.js"><link rel="prefetch" href="/blog/assets/js/27.bdc2a03b.js"><link rel="prefetch" href="/blog/assets/js/28.bafd22a7.js"><link rel="prefetch" href="/blog/assets/js/29.3fc1ea64.js"><link rel="prefetch" href="/blog/assets/js/3.168c0e15.js"><link rel="prefetch" href="/blog/assets/js/30.8b0ded56.js"><link rel="prefetch" href="/blog/assets/js/31.beb339fd.js"><link rel="prefetch" href="/blog/assets/js/32.3ec6ea80.js"><link rel="prefetch" href="/blog/assets/js/34.66b47894.js"><link rel="prefetch" href="/blog/assets/js/35.5fdd5538.js"><link rel="prefetch" href="/blog/assets/js/36.85cbc0ce.js"><link rel="prefetch" href="/blog/assets/js/37.329c6aaf.js"><link rel="prefetch" href="/blog/assets/js/38.f452c830.js"><link rel="prefetch" href="/blog/assets/js/39.c16c6030.js"><link rel="prefetch" href="/blog/assets/js/4.f6488527.js"><link rel="prefetch" href="/blog/assets/js/40.d1f760c1.js"><link rel="prefetch" href="/blog/assets/js/41.57de51f5.js"><link rel="prefetch" href="/blog/assets/js/42.d8ba9086.js"><link rel="prefetch" href="/blog/assets/js/43.4f23320b.js"><link rel="prefetch" href="/blog/assets/js/44.b7797a28.js"><link rel="prefetch" href="/blog/assets/js/5.94131642.js"><link rel="prefetch" href="/blog/assets/js/6.22294c7e.js"><link rel="prefetch" href="/blog/assets/js/7.96080206.js"><link rel="prefetch" href="/blog/assets/js/8.ee4e8f06.js"><link rel="prefetch" href="/blog/assets/js/9.b080a929.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.f87ba6bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">黄伟斌的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/EmotionBin/vue-press-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/EmotionBin/vue-press-blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端琐事</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/articles/debounce-throttle-01.html" class="sidebar-link">防抖和节流</a></li><li><a href="/blog/blog/articles/performance-optimization-01.html" class="sidebar-link">前端性能优化</a></li><li><a href="/blog/blog/articles/cookie-session-token-webstorage-01.html" class="sidebar-link">彻底弄懂 cookie、session、token、webstorage</a></li><li><a href="/blog/blog/articles/login-mode-01.html" class="sidebar-link">第三方登录与单点登录</a></li><li><a href="/blog/blog/articles/web-worker-01.html" class="sidebar-link">Web Worker</a></li><li><a href="/blog/blog/articles/service-worker-01.html" class="sidebar-link">Service Worker</a></li><li><a href="/blog/blog/articles/about-array-01.html" class="sidebar-link">关于数组的一些思考</a></li><li><a href="/blog/blog/articles/cross-domain-01.html" class="sidebar-link">关于跨域问题与解决方案</a></li><li><a href="/blog/blog/articles/scan-login-01.html" aria-current="page" class="active sidebar-link">扫码登录原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/articles/scan-login-01.html#主要流程" class="sidebar-link">主要流程</a></li><li class="sidebar-sub-header"><a href="/blog/blog/articles/scan-login-01.html#具体实现" class="sidebar-link">具体实现</a></li></ul></li><li><a href="/blog/blog/articles/call-app.html" class="sidebar-link">h5 唤起 app</a></li><li><a href="/blog/blog/articles/track.html" class="sidebar-link">埋点监控</a></li><li><a href="/blog/blog/articles/301-302.html" class="sidebar-link">http 状态码 301 与 302</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>跨端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>demo合集</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="扫码登录原理"><a href="#扫码登录原理" class="header-anchor">#</a> 扫码登录原理</h1> <p>二维码扫码登录是我们非常常见的一个场景，今天就来聊一聊扫码登录</p> <hr> <h2 id="主要流程"><a href="#主要流程" class="header-anchor">#</a> 主要流程</h2> <p>这种操作常见于以下场景：你已经在手机设备登录的情况下，需要在电脑 PC 端应用或者网页也登录，这时，如果该应用支持扫码登录，我们就可以拿出手机，扫描 PC 端生成的一个二维码，在手机上确认登录，PC 端就可以登录了</p> <p>比如 QQ 扫码登录、微信扫码登录、微博扫码登录等等</p> <p>现在假设：手机端已经登录了微信，这时候需要在 PC 端也登录</p> <ol><li>PC 端生成一个二维码，等待扫描</li> <li>使用手机端微信的扫一扫功能扫描二维码</li> <li>手机端解析二维码并弹出确认登录弹窗，此时 PC 端的二维码状态显示为：已扫描，等待确认</li> <li>手机端点击确认登录，这时 PC 端的微信完成登录</li></ol> <hr> <h2 id="具体实现"><a href="#具体实现" class="header-anchor">#</a> 具体实现</h2> <p>扫码登录的整个过程中主要有以下几个关键点：</p> <ul><li>在扫码登录整个过程中，手机端和 PC 端是否需要有数据传输</li> <li>在手机端进行确认登录的时候，为什么 PC 端就能直接登录</li> <li>如何保证扫码登录的过程是安全的，非信息暴露泄漏的</li> <li>PC 端是如何检测到二维码的状态的（已扫描、已取消、已确认等）</li></ul> <p><strong>在扫码登录整个过程中，手机端和 PC 端是否需要有数据传输</strong></p> <p>答案是肯定的，手机端和 PC 端是有数据交互的，否则 PC 端是无法进行登录操作的</p> <p>那到底是什么数据在进行交互呢？答案是：一种仅用于扫码登录的临时 token 令牌数据</p> <p>PC 端在生成二维码的时候，向服务端发送一个生成二维码的请求，服务端会生成一个 ID，然后把这个 ID 绑定到生成的二维码里面，再把这个二维码返回给 PC 端，PC 端就会显示这个绑定了 ID 的二维码并且等待扫描</p> <p>当手机设备扫描二维码后，会解析二维码并拿到这个 ID，通过二维码把这个 ID 从 PC 端传输到了手机端，所以手机端和 PC 端是需要有数据传输的</p> <p><strong>在手机端进行确认登录的时候，为什么 PC 端就能直接登录</strong></p> <p>继续前面说的，手机端进行确认登录的时候，会带着这个 ID，以及手机端上已经登录了的用户身份信息 token，一起发送给服务器，服务器接收到后，新生成一个专门给 PC 端使用且绑定了用户身份的 token，然后把这个新的 token 返回给 PC 端，PC 端拿到新的 token 后就相当于登录了，根据这个 token 就可以和服务端通信了</p> <p><strong>如何保证扫码登录的过程是安全的，非信息暴露泄漏的</strong></p> <p>在整个扫码登录过程中，手机端与 PC 端涉及的数据交互，仅仅是由服务器管理控制的一个二维码 ID、手机端上的用户身份 token（有时效性）、服务器新生成给 PC 端的用户身份 token（有时效性），没有敏感信息交互，也就不存在敏感信息的泄漏；服务器给 PC 端生成一个新的 token，从另一个角度上看，就跟用户输入用户名密码登录的本质是一样的，都是基于带时效性的 token 校验机制，只不过扫码登录的方式少了输入用户名密码这一个步骤。因此，这样的一个扫码登录流程是安全的</p> <p><strong>PC 端是如何检测到二维码的状态的（已扫描、已取消、已确认等）</strong></p> <p>无非两种方式：socket 和轮询</p> <p>socket 方式：</p> <p>PC 端保持着与服务器的长连接，当手机端扫描二维码后，带着解析得到的二维码 ID 第一次发送给服务器，当服务器收到这个请求后，代表用户已经扫描了二维码，这时服务器就可以通过 socket 告知 PC 端二维码已被扫描，等待确认；之后手机端不论是取消登录还是确认登录，都会相应的请求服务器，服务器收到请求会根据相应的逻辑处理，进而通知 PC 端更新相应的状态</p> <p>轮询方式：</p> <p>轮询方式即在 PC 端创建一个定时器，每隔一段时间请求服务器查询状态的更新情况，然后更新网页的显示信息。但是这个定时器得控制好启动时机和生命周期，因为 PC 端的二维码有可能一直没有被扫描，或者扫描之后没有下一步操作了，这时，如果没有控制好这个定时器，PC 端就会一直地请求服务器查询，造成资源浪费和一定的性能损耗</p> <p>至此，二维码扫码登录的分析我们已经基本了解了，接下来我们用时序图来描述二维码扫码登录的详细流程：</p> <p><a href="https://z3.ax1x.com/2021/11/21/IX4uDO.png" target="_blank" rel="noopener noreferrer"><img src="https://z3.ax1x.com/2021/11/21/IX4uDO.png" alt="IX4uDO.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>参考资料：</strong></p> <p><a href="https://blog.csdn.net/h_xiao_x/article/details/105920831" target="_blank" rel="noopener noreferrer">二维码扫码登录原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/21/2021, 8:47:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/blog/articles/cross-domain-01.html" class="prev">
        关于跨域问题与解决方案
      </a></span> <span class="next"><a href="/blog/blog/articles/call-app.html">
        h5 唤起 app
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.11eaa6f7.js" defer></script><script src="/blog/assets/js/2.74b5bf19.js" defer></script><script src="/blog/assets/js/33.a7961f50.js" defer></script>
  </body>
</html>
