(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{384:function(t,s,a){"use strict";a.r(s);var n=a(45),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"关于mvc与mvvm以及vue的实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于mvc与mvvm以及vue的实现原理"}},[t._v("#")]),t._v(" 关于MVC与MVVM以及Vue的实现原理")]),t._v(" "),a("p",[t._v("之前一直对MVC和MVVM一知半解，直到最近看了一些相关的文章，才弄懂了MVC和MVVM，于是就打算写这篇文章，来谈谈我对MVC和MVVM的理解。")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"mvc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mvc"}},[t._v("#")]),t._v(" MVC")]),t._v(" "),a("p",[t._v("MVC到底是什么意思，下面引用阮一峰老师的一张图：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/31/GKx1wF.png",alt:"GKx1wF.png"}})]),t._v(" "),a("p",[t._v("从这张图中可以看出MVC就是M（Model）+V（View）+C（Controller），下面来详细讨论他们之间的关系。")]),t._v(" "),a("ul",[a("li",[t._v("视图（View）：用户界面")]),t._v(" "),a("li",[t._v("控制器（Controller）：业务逻辑")]),t._v(" "),a("li",[t._v("模型（Model）：数据保存")])]),t._v(" "),a("p",[t._v("再引用阮一峰老师的一张图说明一下他们之间的通信关系：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/31/GMiU4U.png",alt:"GMiU4U.png"}})]),t._v(" "),a("ol",[a("li",[t._v("View 传送指令到 Controller")]),t._v(" "),a("li",[t._v("Controller 完成业务逻辑后，要求 Model 改变状态")]),t._v(" "),a("li",[t._v("Model 将新的数据发送到 View，用户得到反馈")])]),t._v(" "),a("p",[t._v("view（视图）上发生变化，通过Controller（控件）将响应传入到Model（数据源），由数据源改变View上面的数据。这种方式看似可行，"),a("strong",[t._v("但是如果以后业务逻辑越来越复杂，这种架构就会暴露出很多弊端")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("需要大量调用"),a("code",[t._v("DOM")]),t._v("的API，冗余而繁琐，这样一来代码很难维护")]),t._v(" "),a("li",[t._v("大量"),a("code",[t._v("DOM")]),t._v("操作有可能会使页面渲染性能降低，加载速度变慢，影响用户体验")]),t._v(" "),a("li",[t._v("Model每变化一次，就要手动触发View的渲染更新，如果Model频繁变化，就要不停的手动更新，操作繁琐，这样只会越来越臃肿，而且很难维护复杂多变的数据状态")])]),t._v(" "),a("p",[t._v("其实，早期"),a("code",[t._v("jquery")]),t._v("的出现就是为了前端能更简洁的操作"),a("code",[t._v("DOM")]),t._v("而设计的，但是它只解决了第一个问题，它只是封装了"),a("code",[t._v("DOM")]),t._v("的API的调用方式，确实使得操作"),a("code",[t._v("DOM")]),t._v("的时候变得简洁了，但假如在项目中大量用到了"),a("code",[t._v("DOM")]),t._v("操作，大量的数据变化，这样一来，根本的问题还是没有得到解决。于是到后来MVVM的出现，才解决了以上的问题。")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"mvvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mvvm"}},[t._v("#")]),t._v(" MVVM")]),t._v(" "),a("p",[t._v("MVVM又是什么？MVVM其实就是M（Model）+V（View）+VM（ViewModel）")]),t._v(" "),a("ul",[a("li",[t._v("数据模型（Model）：保存数据")]),t._v(" "),a("li",[t._v("视图（View）：数据的UI展现")]),t._v(" "),a("li",[t._v("ViewModel：一个同步View 和 Model的对象，起到一个连接桥的作用")])]),t._v(" "),a("p",[t._v("这样解释可能还是有点抽象，下面再来看一张图：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/31/GM1osP.png",alt:"GM1osP.png"}})]),t._v(" "),a("p",[t._v("由上图可以看到，View通过ViewModel的"),a("code",[t._v("DOM Listeners")]),t._v("将事件绑定到Model上，而Model则通过"),a("code",[t._v("Data Bindings")]),t._v("来管理View中的数据，ViewModel从中起到一个连接桥的作用。在MVVM架构下，View和Model之间并没有直接的联系，而是通过ViewModel进行交互，Model和 ViewModel之间的交互是双向的，因此View数据的变化会同步到Model中，而Model数据的变化也会立即反应到View上。")]),t._v(" "),a("p",[t._v("可以得出结论，MVVM架构与MVC架构的区别可以概括为：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("实现数据与视图的分离")])]),t._v(" "),a("li",[a("strong",[t._v("数据驱动视图，只需要关心数据变化，DOM操作被封装了")])])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"mvvm实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mvvm实现原理"}},[t._v("#")]),t._v(" MVVM实现原理")]),t._v(" "),a("p",[t._v("下面来解析一下Vue.js中的MVVM架构，先来看一张图：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/03/31/GMUY4K.png",alt:"GMUY4K.png"}})]),t._v(" "),a("p",[t._v("首先要对数据进行劫持监听，所以我们需要设置一个监听器"),a("code",[t._v("Observer")]),t._v("，用来监听所有属性。如果属性发生变化了，就需要告诉订阅者"),a("code",[t._v("Watcher")]),t._v("看是否需要更新。因为订阅者是有很多个，所以我们需要有一个消息订阅器Dep来专门收集这些订阅者，然后在监听器"),a("code",[t._v("Observer")]),t._v("和订阅者"),a("code",[t._v("Watcher")]),t._v("之间进行统一管理的。接着，我们还需要有一个指令解析器"),a("code",[t._v("Compile")]),t._v("，对每个节点元素进行扫描和解析，将相关指令对应初始化成一个订阅者"),a("code",[t._v("Watcher")]),t._v("，并替换模板数据或者绑定相应的函数，此时当订阅者"),a("code",[t._v("Watcher")]),t._v("接收到相应属性的变化，就会执行对应的更新函数，从而更新视图。")]),t._v(" "),a("p",[t._v("可能会有点抽象，接下来一点一点讲解，它的实现主要是三个核心点：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("响应式：vue如何监听data的属性变化")])]),t._v(" "),a("li",[a("strong",[t._v("模板解析：vue的模板是如何被解析的")])]),t._v(" "),a("li",[a("strong",[t._v("渲染：vue模板是如何被渲染成HTML的")])])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"响应式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应式"}},[t._v("#")]),t._v(" 响应式")]),t._v(" "),a("p",[t._v("Vue2.0中响应式原理主要是ES5的"),a("code",[t._v("Object.defineProperty")]),t._v("，其实就是给数据加了一层"),a("strong",[t._v("数据劫持")]),t._v("，每当访问数据（getter）或者修改数据（setter）的时候，Vue都能够检测到数据的一举一动。最近听说Vue3.0准备发布，Vue3.0的响应式操作会改为ES6的"),a("code",[t._v("Proxy")]),t._v("，这里暂时不展开叙述，未来Vue3.0发布了之后再仔细研究。")]),t._v(" "),a("p",[t._v("我曾经看到过一段代码，这段代码简洁精炼的模拟了Vue的响应式原理 "),a("a",{attrs:{href:"https://github.com/answershuto/VueDemo/blob/master/%E3%80%8A%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%8B.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("传送门"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("下面给出另一段简短的代码来模拟Vue的响应式操作：")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Book "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\tObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Book"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'《'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'》'")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tname "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你取了一个书名叫做'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Book"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 《》")]),t._v("\n\t\tBook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue权威指南'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 你取了一个书名叫做vue权威指南")]),t._v("\n\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Book"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 《vue权威指南》")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("通过以上代码示例可以发现，通过"),a("code",[t._v("Object.defineProperty")]),t._v("将Book对象中的name属性添加了get和set监听，这样一来，只要触发了这个属性的getter/setter，都可以监听到。Vue在监听到这个动作之后可以对"),a("code",[t._v("Dom")]),t._v("进行相应处理。")]),t._v(" "),a("p",[a("strong",[t._v("综上所述，Vue的响应式原理可以总结为：当执行 new Vue() 时，Vue 就进入了初始化阶段，一方面Vue 会遍历 data 选项中的属性，并用 Object.defineProperty 将它们转为 getter/setter，实现数据变化监听功能；另一方面，Vue 的指令编译器Compile 对元素节点的指令进行扫描和解析，初始化视图，并订阅 Watcher 来更新视图， 此时Wather 会将自己添加到消息订阅器中(Dep)，初始化完毕。当数据发生变化时，Observer 中的 setter 方法被触发，setter 会立即调用Dep.notify()，Dep 开始遍历所有的订阅者，并调用订阅者的 update 方法，订阅者收到通知后对视图进行相应的更新。")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"模板解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板解析"}},[t._v("#")]),t._v(" 模板解析")]),t._v(" "),a("p",[t._v("模板本质上是一串字符串，它看起来和"),a("code",[t._v("html")]),t._v("的格式很相像，实际上有很大的区别，因为模板本身还带有逻辑运算，比如"),a("code",[t._v("v-if")]),t._v("，"),a("code",[t._v("v-for")]),t._v("等等，但它最后还是要转换为"),a("code",[t._v("html")]),t._v("来显示，模板必须转换成JS函数(render函数),进而转换成"),a("code",[t._v("html")]),t._v("渲染页面。Vue会将模板解析成"),a("code",[t._v("AST")]),t._v("（abstract syntax tree,抽象语法树），然后使用"),a("code",[t._v("AST")]),t._v("生成渲染函数。由于静态节点不需要总是重新渲染，所以生成"),a("code",[t._v("AST")]),t._v("之后，生成渲染函数之前这个阶段，需要做一个优化操作：遍历一遍"),a("code",[t._v("AST")]),t._v("，给所有静态节点做一个标记，这样在虚拟"),a("code",[t._v("DOM")]),t._v("中更新节点时，如果发现这个节点有这个标记，就不会重新渲染它。通过执行渲染函数生成最新的"),a("code",[t._v("vnode")]),t._v("（Virtual DOM），最后根据"),a("code",[t._v("vnode")]),t._v("进行渲染。")]),t._v(" "),a("p",[t._v("模板解析可以总结为三个部分：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("将模板解析成AST")])]),t._v(" "),a("li",[a("strong",[t._v("优化AST树，主要是标记静态节点")])]),t._v(" "),a("li",[a("strong",[t._v("通过调用render函数生成虚拟DOM")])])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染"}},[t._v("#")]),t._v(" 渲染")]),t._v(" "),a("p",[t._v("这里来说一下虚拟"),a("code",[t._v("DOM")]),t._v("，所谓的虚拟"),a("code",[t._v("DOM")]),t._v("，其实就是"),a("strong",[t._v("用JS来模拟DOM结构，把DOM的变化操作放在JS层来做，尽量减少对DOM的操作")]),t._v("（个人认为主要是因为操作JS比操作"),a("code",[t._v("DOM")]),t._v("快了不知道多少倍，JS运行效率高）。然后对比前后两次的虚拟"),a("code",[t._v("DOM")]),t._v("的变化，只重新渲染变化了的部分，而没有变化的部分则不会重新渲染。模板渲染为"),a("code",[t._v("html")]),t._v("分为两种情况，第一种是初次渲染的时候，第二种是渲染之后数据发生改变的时候，首先读取当前的虚拟"),a("code",[t._v("DOM")]),t._v("，判断其是否为空，若为空，则为初次渲染，将虚拟"),a("code",[t._v("DOM")]),t._v("全部渲染到所对应的容器当中，若不为空，则是数据发生了修改，通过响应式我们可以监听到这一情况，使用"),a("code",[t._v("diff")]),t._v("算法完成新旧对比并修改，"),a("code",[t._v("diff")]),t._v("算法会比较原"),a("code",[t._v("vnode")]),t._v("和"),a("code",[t._v("newVnode")]),t._v("的差异，以最小的代价重新渲染页面。")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"v-for为什么要加key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v-for为什么要加key"}},[t._v("#")]),t._v(" v-for为什么要加key")]),t._v(" "),a("p",[t._v("在使用 "),a("code",[t._v("v-for")]),t._v(" 指令时，Vue建议我们都给每个项目加上一个独立的 "),a("code",[t._v("key")]),t._v("，这其中的秘密就是 "),a("code",[t._v("diff")]),t._v(" 算法")]),t._v(" "),a("p",[t._v("来看一段代码，是没有加上 "),a("code",[t._v("key")]),t._v(" 的情况：")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-model")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("添加"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(item, i) in list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("checkbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" {{item.name}}\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    el"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      newId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      list"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'李斯'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'吕不韦'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'嬴政'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注意这里是unshift")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unshift")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br")])]),a("p",[t._v("当选中吕不为时，添加楠楠后选中的确是李斯，并不是我们想要的结果，我们想要的是当添加楠楠后，选中的仍然是吕不韦")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/Usr5kt.png",alt:"Usr5kt.png"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/UsrH1S.png",alt:"UsrH1S.png"}})]),t._v(" "),a("p",[t._v("再来看一段代码，这是加上 "),a("code",[t._v("key")]),t._v(" 的情况，js代码同上：")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-model")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("添加"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(item, i) in list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("item.id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("checkbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" {{item.name}}\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/Usr5kt.png",alt:"Usr5kt.png"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/Ussc40.png",alt:"Ussc40.png"}})]),t._v(" "),a("p",[t._v("同样当选中吕不为时，添加楠楠后依旧选中的是吕不为")]),t._v(" "),a("p",[t._v("可以这样理解，"),a("strong",[t._v("加了key(一定要具有唯一性) id的checkbox跟内容进行了一个关联")])]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"关于diff算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于diff算法"}},[t._v("#")]),t._v(" 关于diff算法")]),t._v(" "),a("p",[t._v("diff算法的处理方法，就是对操作前后的 "),a("code",[t._v("dom")]),t._v(" 树同一层的节点进行对比，一层一层对比:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/Usx9Cq.png",alt:"Usx9Cq.png"}})]),t._v(" "),a("p",[t._v("当某一层有很多相同的节点时，也就是列表节点，diff 算法的更新过程默认情况下也是遵循以上原则，比如有节点 A-E，我们希望在B、C之间加入一个新节点 F，我们期望应该是直接在B、C之间插入节点 F:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/UsxQxK.jpg",alt:"UsxQxK.jpg"}})]),t._v(" "),a("p",[t._v("但是 diff 算法执行起来却是这样的:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/Usx6aj.jpg",alt:"Usx6aj.jpg"}})]),t._v(" "),a("p",[t._v("即把 C 更新成 F，D 更新成 C，E 更新成 D，最后再加入一个新节点 E，这样的效率是非常低的，因为插入位置后面的节点全部都被重新渲染了，而且这种渲染是不必要的，如果我们把各个节点能够对应起来，应该就能够复用节点，这样会好很多。所以用一个唯一的 key 来标识节点，diff 算法就可以正确的识别此节点，找到正确的位置插入新的节点")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://s1.ax1x.com/2020/07/17/UszFJI.jpg",alt:"UszFJI.jpg"}})]),t._v(" "),a("p",[t._v("根据以上例子，总结一下，Vue 中 "),a("code",[t._v("v-for")]),t._v(" 加 "),a("code",[t._v(':key="唯一标识"')]),t._v("(唯一标识可以是 item 里面的 id 等，尽量不要用 index 作为唯一标识，因为增加、删除节点都会改变 index 值）就是为了标识唯一性，Vue 组件是高度复用的，有了 "),a("code",[t._v("key")]),t._v(" 之后，就可以更好的区分各个组件，高效的更新虚拟 "),a("code",[t._v("dom")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"vue-实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-实现原理"}},[t._v("#")]),t._v(" vue 实现原理")]),t._v(" "),a("p",[t._v("关于 vue 具体的实现原理，我有写过一些 demo，主要是关于以下几个方面")]),t._v(" "),a("ul",[a("li",[t._v("vue 的虚拟 dom 的具体实现")]),t._v(" "),a("li",[t._v("vue 的 emit 与 on 具体实现原理")]),t._v(" "),a("li",[t._v("vue 观察者模式具体实现")]),t._v(" "),a("li",[t._v("手写一个简易的 vue 框架")])]),t._v(" "),a("p",[t._v("感兴趣的话可以看这里 "),a("a",{attrs:{href:"https://github.com/EmotionBin/various-demo/tree/master/vue-principle",target:"_blank",rel:"noopener noreferrer"}},[t._v("传送门"),a("OutboundLink")],1)]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"结束语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结束语"}},[t._v("#")]),t._v(" 结束语")]),t._v(" "),a("p",[t._v("以上就是我关于MVC和MVVM的一些理解，如果本文中有说的不正确的地方，欢迎大佬鞭策!")]),t._v(" "),a("p",[a("strong",[t._v("参考资料：")])]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("阮一峰-MVC，MVP 和 MVVM 的图示"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://segmentfault.com/a/1190000015895017",target:"_blank",rel:"noopener noreferrer"}},[t._v("思否-MVVM框架理解及其原理实现"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://www.cnblogs.com/goloving/p/8520030.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MVVM模式理解"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://www.jianshu.com/p/9fc69a38da50",target:"_blank",rel:"noopener noreferrer"}},[t._v("简书-MVVM响应式系统的基本实现原理"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/85105001",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎-Vue 模板编译原理"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://www.jianshu.com/p/4bd5e745ce95",target:"_blank",rel:"noopener noreferrer"}},[t._v("简书-VUE中演示v-for为什么要加key"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);